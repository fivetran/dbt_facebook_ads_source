{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-05-23T22:04:06.733160Z", "invocation_id": "4adf4496-79e6-407a-89ed-72e54520b82c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:05.989930Z", "completed_at": "2024-05-23T22:04:05.996052Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:05.998015Z", "completed_at": "2024-05-23T22:04:05.998036Z"}], "thread_id": "Thread-3", "execution_time": 0.04099297523498535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_ad_set_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:05.977869Z", "completed_at": "2024-05-23T22:04:05.996416Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:05.998311Z", "completed_at": "2024-05-23T22:04:05.998315Z"}], "thread_id": "Thread-2", "execution_time": 0.04196500778198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_ad_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:05.960188Z", "completed_at": "2024-05-23T22:04:05.996696Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:05.998581Z", "completed_at": "2024-05-23T22:04:05.998584Z"}], "thread_id": "Thread-1", "execution_time": 0.04296302795410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_account_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:05.992982Z", "completed_at": "2024-05-23T22:04:05.997754Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.000776Z", "completed_at": "2024-05-23T22:04:06.000779Z"}], "thread_id": "Thread-4", "execution_time": 0.04340791702270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad_actions_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_basic_ad_actions_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_actions_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.015622Z", "completed_at": "2024-05-23T22:04:06.016916Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.017937Z", "completed_at": "2024-05-23T22:04:06.017951Z"}], "thread_id": "Thread-4", "execution_time": 0.014503240585327148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.008395Z", "completed_at": "2024-05-23T22:04:06.017540Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.019965Z", "completed_at": "2024-05-23T22:04:06.019971Z"}], "thread_id": "Thread-2", "execution_time": 0.0183718204498291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_campaign_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.011429Z", "completed_at": "2024-05-23T22:04:06.018677Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.021684Z", "completed_at": "2024-05-23T22:04:06.021687Z"}], "thread_id": "Thread-1", "execution_time": 0.0198361873626709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_creative_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.005162Z", "completed_at": "2024-05-23T22:04:06.019654Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.022407Z", "completed_at": "2024-05-23T22:04:06.022411Z"}], "thread_id": "Thread-3", "execution_time": 0.02143716812133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source`.`facebook_ads_basic_ad_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.025052Z", "completed_at": "2024-05-23T22:04:06.026445Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.030540Z", "completed_at": "2024-05-23T22:04:06.030547Z"}], "thread_id": "Thread-4", "execution_time": 0.011176347732543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.028593Z", "completed_at": "2024-05-23T22:04:06.029884Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.035069Z", "completed_at": "2024-05-23T22:04:06.035074Z"}], "thread_id": "Thread-2", "execution_time": 0.012019157409667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_set_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.031380Z", "completed_at": "2024-05-23T22:04:06.032587Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.036696Z", "completed_at": "2024-05-23T22:04:06.036699Z"}], "thread_id": "Thread-1", "execution_time": 0.01063394546508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_basic_ad_actions_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.033497Z", "completed_at": "2024-05-23T22:04:06.034760Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.037381Z", "completed_at": "2024-05-23T22:04:06.037384Z"}], "thread_id": "Thread-3", "execution_time": 0.010673284530639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_basic_ad_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.039808Z", "completed_at": "2024-05-23T22:04:06.041808Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.045459Z", "completed_at": "2024-05-23T22:04:06.045464Z"}], "thread_id": "Thread-4", "execution_time": 0.012892961502075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.043747Z", "completed_at": "2024-05-23T22:04:06.044925Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.053759Z", "completed_at": "2024-05-23T22:04:06.053764Z"}], "thread_id": "Thread-2", "execution_time": 0.016339778900146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_creative_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.057889Z", "completed_at": "2024-05-23T22:04:06.347732Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.348309Z", "completed_at": "2024-05-23T22:04:06.348316Z"}], "thread_id": "Thread-4", "execution_time": 0.29273080825805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as string) as \n    \n    account_status\n    \n , \n    cast(null as string) as \n    \n    business_country_code\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as string) as \n    \n    currency\n    \n , \n    cast(null as string) as \n    \n    timezone_name\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as bigint) as account_id,\n        _fivetran_synced,\n        name as account_name,\n        account_status,\n        business_country_code,\n        created_time as created_at,\n        currency,\n        timezone_name,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.062324Z", "completed_at": "2024-05-23T22:04:06.351293Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.357383Z", "completed_at": "2024-05-23T22:04:06.357389Z"}], "thread_id": "Thread-2", "execution_time": 0.30112409591674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad_actions", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_actions_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    action_type\n    \n as \n    \n    action_type\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n, \n    \n    \n    inline\n    \n as conversion_value_inline , \n    \n    \n    _1_d_view\n    \n as \n    \n    _1_d_view\n    \n, \n    \n    \n    _7_d_click\n    \n as \n    \n    _7_d_click\n    \n, \n    cast(null as string) as \n    \n    _28_d_click\n    \n \n\n\n        \n\n\n, cast('' as string) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation, \n        lower(action_type) as action_type,\n        cast(ad_id as bigint) as ad_id,\n        date as date_day,\n        cast(coalesce(value, 0) as FLOAT64) as conversion_value\n        \n        \n            \n                \n                    , coalesce(cast(conversion_value_inline as FLOAT64), 0) as conversion_value_inline\n                \n            \n                \n                    , coalesce(cast(_1_d_view as FLOAT64), 0) as _1_d_view\n                \n            \n                \n                    , coalesce(cast(_7_d_click as FLOAT64), 0) as _7_d_click\n                \n            \n                \n                    , coalesce(cast(_28_d_click as FLOAT64), 0) as _28_d_click\n                \n            \n        \n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_actions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.050213Z", "completed_at": "2024-05-23T22:04:06.355618Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.357825Z", "completed_at": "2024-05-23T22:04:06.357829Z"}], "thread_id": "Thread-3", "execution_time": 0.3157811164855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_set_id\n    \n as \n    \n    ad_set_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    creative_id\n    \n as \n    \n    creative_id\n    \n, \n    cast(null as string) as \n    \n    conversion_domain\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_id,\n        name as ad_name,\n        cast(account_id as bigint) as account_id,\n        cast(ad_set_id as bigint) as ad_set_id,   \n        cast(campaign_id as bigint) as campaign_id,\n        cast(creative_id as bigint) as creative_id,\n        conversion_domain,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.046177Z", "completed_at": "2024-05-23T22:04:06.357013Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.359463Z", "completed_at": "2024-05-23T22:04:06.359466Z"}], "thread_id": "Thread-1", "execution_time": 0.3181641101837158, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    end_time\n    \n , \n    cast(null as string) as \n    \n    bid_strategy\n    \n , \n    cast(null as INT64) as \n    \n    daily_budget\n    \n , \n    cast(null as INT64) as \n    \n    budget_remaining\n    \n , \n    cast(null as string) as \n    \n    status\n    \n , \n    cast(null as string) as \n    \n    optimization_goal\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_set_id,\n        name as ad_set_name,\n        cast(account_id as bigint) as account_id,\n        cast(campaign_id as bigint) as campaign_id,\n        start_time as start_at,\n        end_time as end_at,\n        bid_strategy,\n        daily_budget,\n        budget_remaining,\n        status,\n        optimization_goal,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.372904Z", "completed_at": "2024-05-23T22:04:06.382881Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.383440Z", "completed_at": "2024-05-23T22:04:06.383445Z"}], "thread_id": "Thread-1", "execution_time": 0.020843982696533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__account_history_source_relation__account_id___fivetran_synced.f81aca1247", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, _fivetran_synced\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history`\n    group by source_relation, account_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.385142Z", "completed_at": "2024-05-23T22:04:06.391821Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.392368Z", "completed_at": "2024-05-23T22:04:06.392373Z"}], "thread_id": "Thread-1", "execution_time": 0.008324861526489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history__fivetran_synced.0570e35e1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history`\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.394061Z", "completed_at": "2024-05-23T22:04:06.451541Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.452116Z", "completed_at": "2024-05-23T22:04:06.452124Z"}], "thread_id": "Thread-1", "execution_time": 0.05917692184448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history_account_id.f1cf38c40f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__account_history`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.453984Z", "completed_at": "2024-05-23T22:04:06.458321Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.458862Z", "completed_at": "2024-05-23T22:04:06.458867Z"}], "thread_id": "Thread-1", "execution_time": 0.006025075912475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__basic_ad_actions_source_relation__date_day__ad_id__action_type.3f1bea13d9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_id, action_type\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_actions`\n    group by source_relation, date_day, ad_id, action_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.460581Z", "completed_at": "2024-05-23T22:04:06.464229Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.464769Z", "completed_at": "2024-05-23T22:04:06.464774Z"}], "thread_id": "Thread-1", "execution_time": 0.005294084548950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_history_source_relation__ad_id__updated_at.664b870e6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history`\n    group by source_relation, ad_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.466466Z", "completed_at": "2024-05-23T22:04:06.469699Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.470213Z", "completed_at": "2024-05-23T22:04:06.470218Z"}], "thread_id": "Thread-1", "execution_time": 0.0048410892486572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_ad_id.11429d3064", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.471885Z", "completed_at": "2024-05-23T22:04:06.475032Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.475535Z", "completed_at": "2024-05-23T22:04:06.475540Z"}], "thread_id": "Thread-1", "execution_time": 0.005589962005615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_updated_at.250a5a84e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_history`\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.478343Z", "completed_at": "2024-05-23T22:04:06.482027Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.482555Z", "completed_at": "2024-05-23T22:04:06.482560Z"}], "thread_id": "Thread-1", "execution_time": 0.005511045455932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_set_history_source_relation__ad_set_id__updated_at.ff1d43114a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_set_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\n    group by source_relation, ad_set_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.484234Z", "completed_at": "2024-05-23T22:04:06.487421Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.487928Z", "completed_at": "2024-05-23T22:04:06.487932Z"}], "thread_id": "Thread-1", "execution_time": 0.004866838455200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_ad_set_id.e19a1df1bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_set_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\nwhere ad_set_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.489703Z", "completed_at": "2024-05-23T22:04:06.492851Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.493365Z", "completed_at": "2024-05-23T22:04:06.493369Z"}], "thread_id": "Thread-1", "execution_time": 0.004733085632324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_updated_at.ef7fafe0fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.350144Z", "completed_at": "2024-05-23T22:04:06.631397Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.631959Z", "completed_at": "2024-05-23T22:04:06.631965Z"}], "thread_id": "Thread-4", "execution_time": 0.28301310539245605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    stop_time\n    \n , \n    cast(null as string) as \n    \n    status\n    \n , \n    cast(null as INT64) as \n    \n    daily_budget\n    \n , \n    cast(null as INT64) as \n    \n    lifetime_budget\n    \n , \n    cast(null as FLOAT64) as \n    \n    budget_remaining\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        created_time as created_at,\n        cast(account_id as bigint) as account_id,\n        cast(id as bigint) as campaign_id,\n        name as campaign_name,\n        start_time as start_at,\n        stop_time as end_at,\n        status,\n        daily_budget,\n        lifetime_budget,\n        budget_remaining,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.634951Z", "completed_at": "2024-05-23T22:04:06.642837Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.643931Z", "completed_at": "2024-05-23T22:04:06.643938Z"}], "thread_id": "Thread-1", "execution_time": 0.011193037033081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__campaign_history_source_relation__campaign_id__updated_at.82c4f9a2a1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history`\n    group by source_relation, campaign_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.638719Z", "completed_at": "2024-05-23T22:04:06.643155Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.644222Z", "completed_at": "2024-05-23T22:04:06.644226Z"}], "thread_id": "Thread-4", "execution_time": 0.011226892471313477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_campaign_id.1ca7a83852", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.646516Z", "completed_at": "2024-05-23T22:04:06.649866Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.650383Z", "completed_at": "2024-05-23T22:04:06.650388Z"}], "thread_id": "Thread-1", "execution_time": 0.004930019378662109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_updated_at.9e59f99270", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__campaign_history`\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.363525Z", "completed_at": "2024-05-23T22:04:06.695136Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.695724Z", "completed_at": "2024-05-23T22:04:06.695730Z"}], "thread_id": "Thread-2", "execution_time": 0.3353137969970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    page_link\n    \n as \n    \n    page_link\n    \n, \n    \n    \n    template_page_link\n    \n as \n    \n    template_page_link\n    \n, \n    \n    \n    url_tags\n    \n as \n    \n    url_tags\n    \n, \n    \n    \n    asset_feed_spec_link_urls\n    \n as \n    \n    asset_feed_spec_link_urls\n    \n, \n    \n    \n    object_story_link_data_child_attachments\n    \n as \n    \n    object_story_link_data_child_attachments\n    \n, \n    \n    \n    object_story_link_data_caption\n    \n as \n    \n    object_story_link_data_caption\n    \n, \n    \n    \n    object_story_link_data_description\n    \n as \n    \n    object_story_link_data_description\n    \n, \n    \n    \n    object_story_link_data_link\n    \n as \n    \n    object_story_link_data_link\n    \n, \n    \n    \n    object_story_link_data_message\n    \n as \n    \n    object_story_link_data_message\n    \n, \n    cast(null as string) as \n    \n    template_app_link_spec_android\n    \n , \n    \n    \n    template_app_link_spec_ios\n    \n as \n    \n    template_app_link_spec_ios\n    \n, \n    cast(null as string) as \n    \n    template_app_link_spec_ipad\n    \n , \n    cast(null as string) as \n    \n    template_app_link_spec_iphone\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id,\n        _fivetran_synced,\n        cast(id as bigint) as creative_id,\n        cast(account_id as bigint) as account_id,\n        name as creative_name,\n        page_link,\n        template_page_link,\n        url_tags,\n        asset_feed_spec_link_urls,\n        object_story_link_data_child_attachments,\n        object_story_link_data_caption, \n        object_story_link_data_description, \n        object_story_link_data_link, \n        object_story_link_data_message,\n        template_app_link_spec_ios,\n        template_app_link_spec_ipad,\n        template_app_link_spec_android,\n        template_app_link_spec_iphone,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.366940Z", "completed_at": "2024-05-23T22:04:06.695991Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.697198Z", "completed_at": "2024-05-23T22:04:06.697201Z"}], "thread_id": "Thread-3", "execution_time": 0.3362147808074951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    cast(null as string) as \n    \n    ad_name\n    \n , \n    cast(null as string) as \n    \n    adset_name\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    inline_link_clicks\n    \n as \n    \n    inline_link_clicks\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    cast(null as INT64) as \n    \n    reach\n    \n , \n    cast(null as FLOAT64) as \n    \n    frequency\n    \n , \n    cast(null as string) as fake_freq_name \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_id as bigint) as ad_id,\n        ad_name,\n        adset_name as ad_set_name,\n        date as date_day,\n        cast(account_id as bigint) as account_id,\n        impressions,\n        coalesce(inline_link_clicks,0) as clicks,\n        spend\n\n        \n            \n                \n            \n            \n                , frequency\n            \n\n        \n\n\n    \n        \n            \n                , reach\n            \n        \n    \n        \n            \n                , fake_freq_name\n            \n        \n    \n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.701595Z", "completed_at": "2024-05-23T22:04:06.715450Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.717099Z", "completed_at": "2024-05-23T22:04:06.717104Z"}], "thread_id": "Thread-4", "execution_time": 0.019536733627319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__creative_history_source_relation___fivetran_id.2466dae947", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_id\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history`\n    group by source_relation, _fivetran_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.705331Z", "completed_at": "2024-05-23T22:04:06.715747Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.717626Z", "completed_at": "2024-05-23T22:04:06.717629Z"}], "thread_id": "Thread-1", "execution_time": 0.019864797592163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history__fivetran_synced.3b0593cb4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history`\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.712164Z", "completed_at": "2024-05-23T22:04:06.716338Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.718721Z", "completed_at": "2024-05-23T22:04:06.718725Z"}], "thread_id": "Thread-3", "execution_time": 0.0193178653717041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__basic_ad_source_relation__date_day__ad_id__account_id.9c647961f0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_id, account_id\n    from `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad`\n    group by source_relation, date_day, ad_id, account_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.709130Z", "completed_at": "2024-05-23T22:04:06.716827Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.719501Z", "completed_at": "2024-05-23T22:04:06.719504Z"}], "thread_id": "Thread-2", "execution_time": 0.021052837371826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history_creative_id.eb4d804261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__creative_history`\nwhere creative_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.722743Z", "completed_at": "2024-05-23T22:04:06.729064Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.730096Z", "completed_at": "2024-05-23T22:04:06.730101Z"}], "thread_id": "Thread-4", "execution_time": 0.009439229965209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_account_id.d06f6d861b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T22:04:06.725856Z", "completed_at": "2024-05-23T22:04:06.729353Z"}, {"name": "execute", "started_at": "2024-05-23T22:04:06.730366Z", "completed_at": "2024-05-23T22:04:06.730369Z"}], "thread_id": "Thread-1", "execution_time": 0.009536981582641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_ad_id.2611b250fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`facebook_ads_source_facebook_ads_source`.`stg_facebook_ads__basic_ad`\nwhere ad_id is null\n\n\n", "relation_name": null}], "elapsed_time": 1.6870777606964111, "args": {"exclude": [], "static_parser": true, "quiet": false, "enable_legacy_logger": false, "partial_parse_file_diff": true, "populate_cache": true, "send_anonymous_usage_stats": true, "cache_selected_only": false, "partial_parse": true, "log_level_file": "debug", "log_file_max_bytes": 10485760, "profiles_dir": "/Users/jamie.rodriguez/.dbt", "use_colors": true, "macro_debugging": false, "printer_width": 80, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "empty_catalog": false, "compile": true, "static": false, "show_resource_report": false, "defer": false, "use_colors_file": true, "log_format": "default", "invocation_command": "dbt docs generate", "log_format_file": "debug", "introspect": true, "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Facebook_ads/dbt_facebook_ads_source/integration_tests", "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Facebook_ads/dbt_facebook_ads_source/integration_tests/logs", "which": "generate", "indirect_selection": "eager", "version_check": true, "select": [], "vars": {}, "write_json": true, "print": true, "log_level": "info"}}
