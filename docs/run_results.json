{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-05-03T17:02:11.128036Z", "invocation_id": "a629f31f-1f66-4068-960a-9ab741c7d906", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:09.976578Z", "completed_at": "2024-05-03T17:02:10.017599Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.018854Z", "completed_at": "2024-05-03T17:02:10.018875Z"}], "thread_id": "Thread-3", "execution_time": 0.08553814888000488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_ad_set_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:09.937051Z", "completed_at": "2024-05-03T17:02:10.018489Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.021496Z", "completed_at": "2024-05-03T17:02:10.021508Z"}], "thread_id": "Thread-1", "execution_time": 0.08972692489624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_account_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:09.948876Z", "completed_at": "2024-05-03T17:02:10.019163Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.022628Z", "completed_at": "2024-05-03T17:02:10.022633Z"}], "thread_id": "Thread-2", "execution_time": 0.09042191505432129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_ad_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.001006Z", "completed_at": "2024-05-03T17:02:10.020655Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.024031Z", "completed_at": "2024-05-03T17:02:10.024035Z"}], "thread_id": "Thread-4", "execution_time": 0.09046697616577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_basic_ad_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.026795Z", "completed_at": "2024-05-03T17:02:10.036373Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.041681Z", "completed_at": "2024-05-03T17:02:10.041688Z"}], "thread_id": "Thread-3", "execution_time": 0.01944589614868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_campaign_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.036955Z", "completed_at": "2024-05-03T17:02:10.038307Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.042275Z", "completed_at": "2024-05-03T17:02:10.042279Z"}], "thread_id": "Thread-2", "execution_time": 0.01305079460144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.038974Z", "completed_at": "2024-05-03T17:02:10.041067Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.043390Z", "completed_at": "2024-05-03T17:02:10.043393Z"}], "thread_id": "Thread-4", "execution_time": 0.013212919235229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.032674Z", "completed_at": "2024-05-03T17:02:10.042564Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.045602Z", "completed_at": "2024-05-03T17:02:10.045605Z"}], "thread_id": "Thread-1", "execution_time": 0.02083587646484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`facebook_ads_source_testing`.`facebook_ads_creative_history_data`", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.048657Z", "completed_at": "2024-05-03T17:02:10.049839Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.054248Z", "completed_at": "2024-05-03T17:02:10.054252Z"}], "thread_id": "Thread-3", "execution_time": 0.01059579849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_set_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.050362Z", "completed_at": "2024-05-03T17:02:10.051445Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.054724Z", "completed_at": "2024-05-03T17:02:10.054727Z"}], "thread_id": "Thread-2", "execution_time": 0.010741949081420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_basic_ad_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.052368Z", "completed_at": "2024-05-03T17:02:10.053504Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.056825Z", "completed_at": "2024-05-03T17:02:10.056828Z"}], "thread_id": "Thread-4", "execution_time": 0.010625839233398438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.054978Z", "completed_at": "2024-05-03T17:02:10.056036Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.059104Z", "completed_at": "2024-05-03T17:02:10.059109Z"}], "thread_id": "Thread-1", "execution_time": 0.008997917175292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_creative_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.062171Z", "completed_at": "2024-05-03T17:02:10.543798Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.545228Z", "completed_at": "2024-05-03T17:02:10.545234Z"}], "thread_id": "Thread-3", "execution_time": 0.48687195777893066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    end_time\n    \n , \n    cast(null as string) as \n    \n    bid_strategy\n    \n , \n    cast(null as INT64) as \n    \n    daily_budget\n    \n , \n    cast(null as INT64) as \n    \n    budget_remaining\n    \n , \n    cast(null as string) as \n    \n    status\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_set_id,\n        name as ad_set_name,\n        cast(account_id as bigint) as account_id,\n        cast(campaign_id as bigint) as campaign_id,\n        start_time as start_at,\n        end_time as end_at,\n        bid_strategy,\n        daily_budget,\n        budget_remaining,\n        status,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.075357Z", "completed_at": "2024-05-03T17:02:10.544165Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.545743Z", "completed_at": "2024-05-03T17:02:10.545746Z"}], "thread_id": "Thread-1", "execution_time": 0.47765564918518066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    cast(null as string) as \n    \n    ad_name\n    \n , \n    cast(null as string) as \n    \n    adset_name\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    inline_link_clicks\n    \n as \n    \n    inline_link_clicks\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    cast(null as INT64) as \n    \n    reach\n    \n , \n    cast(null as FLOAT64) as \n    \n    frequency\n    \n , \n    cast(null as string) as fake_freq_name \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_id as bigint) as ad_id,\n        ad_name,\n        adset_name as ad_set_name,\n        date as date_day,\n        cast(account_id as bigint) as account_id,\n        impressions,\n        coalesce(inline_link_clicks,0) as clicks,\n        spend\n\n        \n            \n                \n            \n            \n                , frequency\n            \n\n        \n\n\n    \n        \n            \n                , reach\n            \n        \n    \n        \n            \n                , fake_freq_name\n            \n        \n    \n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.070404Z", "completed_at": "2024-05-03T17:02:10.544713Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.546609Z", "completed_at": "2024-05-03T17:02:10.546613Z"}], "thread_id": "Thread-4", "execution_time": 0.4867258071899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_set_id\n    \n as \n    \n    ad_set_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    creative_id\n    \n as \n    \n    creative_id\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_id,\n        name as ad_name,\n        cast(account_id as bigint) as account_id,\n        cast(ad_set_id as bigint) as ad_set_id,   \n        cast(campaign_id as bigint) as campaign_id,\n        cast(creative_id as bigint) as creative_id,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.558128Z", "completed_at": "2024-05-03T17:02:10.568197Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.568741Z", "completed_at": "2024-05-03T17:02:10.568745Z"}], "thread_id": "Thread-4", "execution_time": 0.01912403106689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_set_history_source_relation__ad_set_id__updated_at.ff1d43114a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_set_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\n    group by source_relation, ad_set_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.570459Z", "completed_at": "2024-05-03T17:02:10.576575Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.577114Z", "completed_at": "2024-05-03T17:02:10.577119Z"}], "thread_id": "Thread-4", "execution_time": 0.007771015167236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_ad_set_id.e19a1df1bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_set_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\nwhere ad_set_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.065780Z", "completed_at": "2024-05-03T17:02:10.587337Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.587897Z", "completed_at": "2024-05-03T17:02:10.587905Z"}], "thread_id": "Thread-2", "execution_time": 0.528533935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as string) as \n    \n    account_status\n    \n , \n    cast(null as string) as \n    \n    business_country_code\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as string) as \n    \n    currency\n    \n , \n    cast(null as string) as \n    \n    timezone_name\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as bigint) as account_id,\n        _fivetran_synced,\n        name as account_name,\n        account_status,\n        business_country_code,\n        created_time as created_at,\n        currency,\n        timezone_name,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.584252Z", "completed_at": "2024-05-03T17:02:10.588185Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.589542Z", "completed_at": "2024-05-03T17:02:10.589546Z"}], "thread_id": "Thread-4", "execution_time": 0.0068280696868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_updated_at.ef7fafe0fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_set_history`\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.591204Z", "completed_at": "2024-05-03T17:02:10.598695Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.599235Z", "completed_at": "2024-05-03T17:02:10.599239Z"}], "thread_id": "Thread-2", "execution_time": 0.009893178939819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__basic_ad_source_relation__date_day__ad_id__account_id.9c647961f0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_id, account_id\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad`\n    group by source_relation, date_day, ad_id, account_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.595740Z", "completed_at": "2024-05-03T17:02:10.604167Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.605289Z", "completed_at": "2024-05-03T17:02:10.605296Z"}], "thread_id": "Thread-4", "execution_time": 0.011049985885620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_account_id.d06f6d861b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.600910Z", "completed_at": "2024-05-03T17:02:10.604476Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.605586Z", "completed_at": "2024-05-03T17:02:10.605589Z"}], "thread_id": "Thread-2", "execution_time": 0.006343841552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_ad_id.2611b250fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__basic_ad`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.654648Z", "completed_at": "2024-05-03T17:02:10.665764Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.666295Z", "completed_at": "2024-05-03T17:02:10.666302Z"}], "thread_id": "Thread-2", "execution_time": 0.05862021446228027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_ad_id.11429d3064", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.609275Z", "completed_at": "2024-05-03T17:02:10.670918Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.671505Z", "completed_at": "2024-05-03T17:02:10.671509Z"}], "thread_id": "Thread-4", "execution_time": 0.06436514854431152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_history_source_relation__ad_id__updated_at.664b870e6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history`\n    group by source_relation, ad_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.667948Z", "completed_at": "2024-05-03T17:02:10.672590Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.673770Z", "completed_at": "2024-05-03T17:02:10.673773Z"}], "thread_id": "Thread-2", "execution_time": 0.010174989700317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_updated_at.250a5a84e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__ad_history`\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.674027Z", "completed_at": "2024-05-03T17:02:10.681707Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.682241Z", "completed_at": "2024-05-03T17:02:10.682245Z"}], "thread_id": "Thread-4", "execution_time": 0.009834051132202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__account_history_source_relation__account_id___fivetran_synced.f81aca1247", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, _fivetran_synced\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history`\n    group by source_relation, account_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.678840Z", "completed_at": "2024-05-03T17:02:10.683316Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.684528Z", "completed_at": "2024-05-03T17:02:10.684532Z"}], "thread_id": "Thread-2", "execution_time": 0.009915828704833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history__fivetran_synced.0570e35e1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history`\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.684824Z", "completed_at": "2024-05-03T17:02:10.688719Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.689405Z", "completed_at": "2024-05-03T17:02:10.689409Z"}], "thread_id": "Thread-4", "execution_time": 0.006331205368041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history_account_id.f1cf38c40f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__account_history`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.554551Z", "completed_at": "2024-05-03T17:02:10.941786Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.942881Z", "completed_at": "2024-05-03T17:02:10.942890Z"}], "thread_id": "Thread-1", "execution_time": 0.39429616928100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    page_link\n    \n as \n    \n    page_link\n    \n, \n    \n    \n    template_page_link\n    \n as \n    \n    template_page_link\n    \n, \n    \n    \n    url_tags\n    \n as \n    \n    url_tags\n    \n, \n    \n    \n    asset_feed_spec_link_urls\n    \n as \n    \n    asset_feed_spec_link_urls\n    \n, \n    \n    \n    object_story_link_data_child_attachments\n    \n as \n    \n    object_story_link_data_child_attachments\n    \n, \n    \n    \n    object_story_link_data_caption\n    \n as \n    \n    object_story_link_data_caption\n    \n, \n    \n    \n    object_story_link_data_description\n    \n as \n    \n    object_story_link_data_description\n    \n, \n    \n    \n    object_story_link_data_link\n    \n as \n    \n    object_story_link_data_link\n    \n, \n    \n    \n    object_story_link_data_message\n    \n as \n    \n    object_story_link_data_message\n    \n, \n    cast(null as string) as \n    \n    template_app_link_spec_android\n    \n , \n    \n    \n    template_app_link_spec_ios\n    \n as \n    \n    template_app_link_spec_ios\n    \n, \n    cast(null as string) as \n    \n    template_app_link_spec_ipad\n    \n , \n    cast(null as string) as \n    \n    template_app_link_spec_iphone\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id,\n        _fivetran_synced,\n        cast(id as bigint) as creative_id,\n        cast(account_id as bigint) as account_id,\n        name as creative_name,\n        page_link,\n        template_page_link,\n        url_tags,\n        asset_feed_spec_link_urls,\n        object_story_link_data_child_attachments,\n        object_story_link_data_caption, \n        object_story_link_data_description, \n        object_story_link_data_link, \n        object_story_link_data_message,\n        template_app_link_spec_ios,\n        template_app_link_spec_ipad,\n        template_app_link_spec_android,\n        template_app_link_spec_iphone,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.948825Z", "completed_at": "2024-05-03T17:02:10.963152Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.963980Z", "completed_at": "2024-05-03T17:02:10.963986Z"}], "thread_id": "Thread-2", "execution_time": 0.019168615341186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__creative_history_source_relation___fivetran_id.2466dae947", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_id\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history`\n    group by source_relation, _fivetran_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.958960Z", "completed_at": "2024-05-03T17:02:10.965151Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.965912Z", "completed_at": "2024-05-03T17:02:10.965917Z"}], "thread_id": "Thread-1", "execution_time": 0.019089937210083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history_creative_id.eb4d804261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history`\nwhere creative_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.954643Z", "completed_at": "2024-05-03T17:02:10.966274Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:10.967642Z", "completed_at": "2024-05-03T17:02:10.967647Z"}], "thread_id": "Thread-4", "execution_time": 0.021574020385742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history__fivetran_synced.3b0593cb4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__creative_history`\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:10.550721Z", "completed_at": "2024-05-03T17:02:11.097755Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:11.098843Z", "completed_at": "2024-05-03T17:02:11.098852Z"}], "thread_id": "Thread-3", "execution_time": 0.5511190891265869, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    stop_time\n    \n , \n    cast(null as string) as \n    \n    status\n    \n , \n    cast(null as INT64) as \n    \n    daily_budget\n    \n , \n    cast(null as INT64) as \n    \n    lifetime_budget\n    \n , \n    cast(null as FLOAT64) as \n    \n    budget_remaining\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        created_time as created_at,\n        cast(account_id as bigint) as account_id,\n        cast(id as bigint) as campaign_id,\n        name as campaign_name,\n        start_time as start_at,\n        stop_time as end_at,\n        status,\n        daily_budget,\n        lifetime_budget,\n        budget_remaining,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:11.104962Z", "completed_at": "2024-05-03T17:02:11.120801Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:11.121634Z", "completed_at": "2024-05-03T17:02:11.121641Z"}], "thread_id": "Thread-2", "execution_time": 0.020704030990600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__campaign_history_source_relation__campaign_id__updated_at.82c4f9a2a1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_at\n    from `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history`\n    group by source_relation, campaign_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:11.112225Z", "completed_at": "2024-05-03T17:02:11.122807Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:11.124302Z", "completed_at": "2024-05-03T17:02:11.124306Z"}], "thread_id": "Thread-1", "execution_time": 0.022459983825683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_campaign_id.1ca7a83852", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-03T17:02:11.116670Z", "completed_at": "2024-05-03T17:02:11.123329Z"}, {"name": "execute", "started_at": "2024-05-03T17:02:11.124646Z", "completed_at": "2024-05-03T17:02:11.124650Z"}], "thread_id": "Thread-4", "execution_time": 0.021956920623779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_updated_at.9e59f99270", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `dbt-package-testing`.`facebook_ads_source_testing_facebook_ads_source`.`stg_facebook_ads__campaign_history`\nwhere updated_at is null\n\n\n", "relation_name": null}], "elapsed_time": 2.4211902618408203, "args": {"partial_parse_file_diff": true, "log_level": "info", "empty_catalog": false, "enable_legacy_logger": false, "write_json": true, "use_colors_file": true, "populate_cache": true, "printer_width": 80, "show_resource_report": false, "which": "generate", "log_format": "default", "cache_selected_only": false, "compile": true, "version_check": true, "partial_parse": true, "use_colors": true, "macro_debugging": false, "strict_mode": false, "static": false, "vars": {}, "exclude": [], "log_level_file": "debug", "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Facebook_ads/dbt_facebook_ads_source/integration_tests", "static_parser": true, "favor_state": false, "select": [], "log_format_file": "debug", "defer": false, "send_anonymous_usage_stats": true, "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Facebook_ads/dbt_facebook_ads_source/integration_tests/logs", "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "print": true, "introspect": true, "indirect_selection": "eager", "quiet": false, "invocation_command": "dbt docs generate", "profiles_dir": "/Users/jamie.rodriguez/.dbt"}}