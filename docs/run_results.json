{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.7", "generated_at": "2024-02-06T21:34:28.784754Z", "invocation_id": "cdb6ccc4-57fe-4469-8f9a-bfc82425ffe9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.583029Z", "completed_at": "2024-02-06T21:34:25.586048Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.587531Z", "completed_at": "2024-02-06T21:34:25.587548Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05733823776245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_basic_ad_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.533587Z", "completed_at": "2024-02-06T21:34:25.586397Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.588147Z", "completed_at": "2024-02-06T21:34:25.588150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06058692932128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_account_history_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.580363Z", "completed_at": "2024-02-06T21:34:25.586867Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.588862Z", "completed_at": "2024-02-06T21:34:25.588865Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05968523025512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_ad_set_history_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.557848Z", "completed_at": "2024-02-06T21:34:25.587086Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.589085Z", "completed_at": "2024-02-06T21:34:25.589088Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06087613105773926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_ad_history_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.599677Z", "completed_at": "2024-02-06T21:34:25.600606Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.602908Z", "completed_at": "2024-02-06T21:34:25.602914Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01134634017944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.600905Z", "completed_at": "2024-02-06T21:34:25.601858Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.603611Z", "completed_at": "2024-02-06T21:34:25.603614Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011873960494995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.593552Z", "completed_at": "2024-02-06T21:34:25.602448Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.604512Z", "completed_at": "2024-02-06T21:34:25.604514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014741897583007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_campaign_history_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.596623Z", "completed_at": "2024-02-06T21:34:25.603160Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.605448Z", "completed_at": "2024-02-06T21:34:25.605451Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014834165573120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2\".\"facebook_ads_creative_history_data\"", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.608777Z", "completed_at": "2024-02-06T21:34:25.609931Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.614529Z", "completed_at": "2024-02-06T21:34:25.614534Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010104179382324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_ad_set_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.610870Z", "completed_at": "2024-02-06T21:34:25.611828Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.616052Z", "completed_at": "2024-02-06T21:34:25.616056Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009896039962768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_basic_ad_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.612523Z", "completed_at": "2024-02-06T21:34:25.614087Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.616922Z", "completed_at": "2024-02-06T21:34:25.616925Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010009050369262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.614771Z", "completed_at": "2024-02-06T21:34:25.615589Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:25.617842Z", "completed_at": "2024-02-06T21:34:25.617846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009338140487670898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.facebook_ads_source_integration_tests_2.facebook_ads_creative_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.628860Z", "completed_at": "2024-02-06T21:34:26.971010Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:26.971889Z", "completed_at": "2024-02-06T21:34:26.971901Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.497189998626709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as TEXT) as \n    \n    account_status\n    \n , \n    cast(null as TEXT) as \n    \n    business_country_code\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as TEXT) as \n    \n    currency\n    \n , \n    cast(null as TEXT) as \n    \n    timezone_name\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as bigint) as account_id,\n        _fivetran_synced,\n        name as account_name,\n        account_status,\n        business_country_code,\n        created_time as created_at,\n        currency,\n        timezone_name,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.632974Z", "completed_at": "2024-02-06T21:34:27.119662Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.127834Z", "completed_at": "2024-02-06T21:34:27.127844Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6309921741485596, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_set_id\n    \n as \n    \n    ad_set_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    creative_id\n    \n as \n    \n    creative_id\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_id,\n        name as ad_name,\n        cast(account_id as bigint) as account_id,\n        cast(ad_set_id as bigint) as ad_set_id,   \n        cast(campaign_id as bigint) as campaign_id,\n        cast(creative_id as bigint) as creative_id,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.621903Z", "completed_at": "2024-02-06T21:34:27.120361Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.128625Z", "completed_at": "2024-02-06T21:34:27.128630Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6354811191558838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__basic_ad", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    cast(null as TEXT) as \n    \n    ad_name\n    \n , \n    cast(null as TEXT) as \n    \n    adset_name\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    inline_link_clicks\n    \n as \n    \n    inline_link_clicks\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    cast(null as integer) as \n    \n    reach\n    \n , \n    cast(null as float) as \n    \n    frequency\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_id as bigint) as ad_id,\n        ad_name,\n        adset_name as ad_set_name,\n        date as date_day,\n        cast(account_id as bigint) as account_id,\n        impressions,\n        coalesce(inline_link_clicks,0) as clicks,\n        spend,\n        reach,\n        frequency\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:25.637861Z", "completed_at": "2024-02-06T21:34:27.120662Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.129029Z", "completed_at": "2024-02-06T21:34:27.129035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6293318271636963, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__ad_set_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    end_time\n    \n , \n    cast(null as TEXT) as \n    \n    bid_strategy\n    \n , \n    cast(null as integer) as \n    \n    daily_budget\n    \n , \n    cast(null as integer) as \n    \n    budget_remaining\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_set_id,\n        name as ad_set_name,\n        cast(account_id as bigint) as account_id,\n        cast(campaign_id as bigint) as campaign_id,\n        start_time as start_at,\n        end_time as end_at,\n        bid_strategy,\n        daily_budget,\n        budget_remaining,\n        status,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.290191Z", "completed_at": "2024-02-06T21:34:27.300362Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.301982Z", "completed_at": "2024-02-06T21:34:27.301992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03882312774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history__fivetran_synced.0570e35e1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history\"\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.274023Z", "completed_at": "2024-02-06T21:34:27.300820Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.302364Z", "completed_at": "2024-02-06T21:34:27.302368Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04061293601989746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__account_history_source_relation__account_id___fivetran_synced.f81aca1247", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, _fivetran_synced\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history\"\n    group by source_relation, account_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.306716Z", "completed_at": "2024-02-06T21:34:27.314694Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.315892Z", "completed_at": "2024-02-06T21:34:27.315898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011675357818603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__account_history_account_id.f1cf38c40f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.310431Z", "completed_at": "2024-02-06T21:34:27.315039Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.316217Z", "completed_at": "2024-02-06T21:34:27.316220Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011712789535522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_history_source_relation__ad_id__updated_at.664b870e6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, updated_at\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history\"\n    group by source_relation, ad_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.319723Z", "completed_at": "2024-02-06T21:34:27.327158Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.328216Z", "completed_at": "2024-02-06T21:34:27.328221Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01050710678100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__basic_ad_source_relation__date_day__ad_id__account_id.9c647961f0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_id, account_id\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad\"\n    group by source_relation, date_day, ad_id, account_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.323909Z", "completed_at": "2024-02-06T21:34:27.327438Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.328468Z", "completed_at": "2024-02-06T21:34:27.328471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010561943054199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_ad_id.11429d3064", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.331416Z", "completed_at": "2024-02-06T21:34:27.336708Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.337587Z", "completed_at": "2024-02-06T21:34:27.337591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007981061935424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_history_updated_at.250a5a84e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_history\"\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.334123Z", "completed_at": "2024-02-06T21:34:27.336944Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.337813Z", "completed_at": "2024-02-06T21:34:27.337816Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008081912994384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_account_id.d06f6d861b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.340701Z", "completed_at": "2024-02-06T21:34:27.347047Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.347986Z", "completed_at": "2024-02-06T21:34:27.347991Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009081125259399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__basic_ad_ad_id.2611b250fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__basic_ad\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.343511Z", "completed_at": "2024-02-06T21:34:27.347294Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.348222Z", "completed_at": "2024-02-06T21:34:27.348225Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009247064590454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__ad_set_history_source_relation__ad_set_id__updated_at.ff1d43114a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_set_id, updated_at\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history\"\n    group by source_relation, ad_set_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.351222Z", "completed_at": "2024-02-06T21:34:27.356681Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.357583Z", "completed_at": "2024-02-06T21:34:27.357588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008133888244628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_ad_set_id.e19a1df1bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_set_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history\"\nwhere ad_set_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.353874Z", "completed_at": "2024-02-06T21:34:27.356927Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:27.357824Z", "completed_at": "2024-02-06T21:34:27.357827Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008244037628173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__ad_set_history_updated_at.ef7fafe0fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__ad_set_history\"\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.121271Z", "completed_at": "2024-02-06T21:34:28.534789Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.535342Z", "completed_at": "2024-02-06T21:34:28.535350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5533909797668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n, \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as timestamp) as \n    \n    stop_time\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n , \n    cast(null as integer) as \n    \n    daily_budget\n    \n , \n    cast(null as integer) as \n    \n    lifetime_budget\n    \n , \n    cast(null as float) as \n    \n    budget_remaining\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        created_time as created_at,\n        cast(account_id as bigint) as account_id,\n        cast(id as bigint) as campaign_id,\n        name as campaign_name,\n        start_time as start_at,\n        stop_time as end_at,\n        status,\n        daily_budget,\n        lifetime_budget,\n        budget_remaining,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.680238Z", "completed_at": "2024-02-06T21:34:28.687557Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.688909Z", "completed_at": "2024-02-06T21:34:28.688917Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015130043029785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_campaign_id.1ca7a83852", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.676357Z", "completed_at": "2024-02-06T21:34:28.687909Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.689356Z", "completed_at": "2024-02-06T21:34:28.689359Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0164029598236084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__campaign_history_source_relation__campaign_id__updated_at.82c4f9a2a1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_at\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history\"\n    group by source_relation, campaign_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.684260Z", "completed_at": "2024-02-06T21:34:28.688454Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.690153Z", "completed_at": "2024-02-06T21:34:28.690156Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0156857967376709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__campaign_history_updated_at.9e59f99270", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__campaign_history\"\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:27.265199Z", "completed_at": "2024-02-06T21:34:28.646413Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.647125Z", "completed_at": "2024-02-06T21:34:28.647133Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4941329956054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.facebook_ads_source.stg_facebook_ads__creative_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    page_link\n    \n as \n    \n    page_link\n    \n, \n    \n    \n    template_page_link\n    \n as \n    \n    template_page_link\n    \n, \n    \n    \n    url_tags\n    \n as \n    \n    url_tags\n    \n, \n    \n    \n    asset_feed_spec_link_urls\n    \n as \n    \n    asset_feed_spec_link_urls\n    \n, \n    \n    \n    object_story_link_data_child_attachments\n    \n as \n    \n    object_story_link_data_child_attachments\n    \n, \n    \n    \n    object_story_link_data_caption\n    \n as \n    \n    object_story_link_data_caption\n    \n, \n    \n    \n    object_story_link_data_description\n    \n as \n    \n    object_story_link_data_description\n    \n, \n    \n    \n    object_story_link_data_link\n    \n as \n    \n    object_story_link_data_link\n    \n, \n    \n    \n    object_story_link_data_message\n    \n as \n    \n    object_story_link_data_message\n    \n, \n    cast(null as TEXT) as \n    \n    template_app_link_spec_android\n    \n , \n    \n    \n    template_app_link_spec_ios\n    \n as \n    \n    template_app_link_spec_ios\n    \n, \n    cast(null as TEXT) as \n    \n    template_app_link_spec_ipad\n    \n , \n    cast(null as TEXT) as \n    \n    template_app_link_spec_iphone\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id,\n        _fivetran_synced,\n        cast(id as bigint) as creative_id,\n        cast(account_id as bigint) as account_id,\n        name as creative_name,\n        page_link,\n        template_page_link,\n        url_tags,\n        asset_feed_spec_link_urls,\n        object_story_link_data_child_attachments,\n        object_story_link_data_caption, \n        object_story_link_data_description, \n        object_story_link_data_link, \n        object_story_link_data_message,\n        template_app_link_spec_ios,\n        template_app_link_spec_ipad,\n        template_app_link_spec_android,\n        template_app_link_spec_iphone,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.765446Z", "completed_at": "2024-02-06T21:34:28.777904Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.780044Z", "completed_at": "2024-02-06T21:34:28.780060Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021103858947753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.dbt_utils_unique_combination_of_columns_stg_facebook_ads__creative_history_source_relation___fivetran_id.2466dae947", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_id\n    from \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history\"\n    group by source_relation, _fivetran_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.770710Z", "completed_at": "2024-02-06T21:34:28.778365Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.780459Z", "completed_at": "2024-02-06T21:34:28.780463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020428180694580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history__fivetran_synced.3b0593cb4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_synced\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history\"\nwhere _fivetran_synced is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-06T21:34:28.774177Z", "completed_at": "2024-02-06T21:34:28.779647Z"}, {"name": "execute", "started_at": "2024-02-06T21:34:28.782171Z", "completed_at": "2024-02-06T21:34:28.782176Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020263195037841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.facebook_ads_source.not_null_stg_facebook_ads__creative_history_creative_id.eb4d804261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom \"postgres\".\"facebook_ads_source_integration_tests_2_facebook_ads_source\".\"stg_facebook_ads__creative_history\"\nwhere creative_id is null\n\n\n", "relation_name": null}], "elapsed_time": 6.73567008972168, "args": {"compile": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/facebook_ads/dbt_facebook_ads_source/integration_tests", "log_format_file": "debug", "printer_width": 80, "introspect": true, "log_level_file": "debug", "cache_selected_only": false, "use_colors": true, "send_anonymous_usage_stats": true, "which": "generate", "write_json": true, "log_level": "info", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/facebook_ads/dbt_facebook_ads_source/integration_tests/logs", "macro_debugging": false, "version_check": true, "indirect_selection": "eager", "defer": false, "static_parser": true, "populate_cache": true, "strict_mode": false, "quiet": false, "enable_legacy_logger": false, "favor_state": false, "print": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "show_resource_report": false, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "static": false, "vars": {}, "invocation_command": "dbt docs generate -t postgres", "partial_parse": true, "select": [], "use_colors_file": true, "empty_catalog": false, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "target": "postgres", "log_format": "default"}}